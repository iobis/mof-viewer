(this["webpackJsonpmof-viewer"]=this["webpackJsonpmof-viewer"]||[]).push([[0],{13:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(6),a=n.n(s),i=(n(13),n(8)),o=n(2),l=n(7),j=n.n(l),u=n(0);var m=new Intl.NumberFormat,d=function(e,t,n){return Object(u.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:t},n)};var b=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(null),a=Object(o.a)(s,2),l=a[0],b=a[1],h=Object(r.useState)([]),p=Object(o.a)(h,2),f=p[0],O=p[1],x=Object(r.useState)(""),v=Object(o.a)(x,2),y=v[0],T=v[1],g=Object(r.useState)("records"),N=Object(o.a)(g,2),w=N[0],I=N[1],k=Object(r.useState)(!1),D=Object(o.a)(k,2),C=D[0],L=D[1],S=Object(r.useRef)("records");return function(e,t,n){var c=Object(r.useCallback)(e,n);Object(r.useEffect)((function(){var e=setTimeout((function(){c()}),t);return function(){clearTimeout(e)}}),[c,t])}((function(){if(n&&n.length>0){var e=n.map((function(e){return e.measurementType&&e.measurementType.toLowerCase().includes(y.toLowerCase())?e.hide=!1:e.hide=!0,e}));c(e)}}),500,[y]),Object(r.useEffect)((function(){fetch("https://api.obis.org/facet?facets=measurementTypeCombination&dropped=include&absence=include&size=10000").then((function(e){return e.json()})).then((function(e){return c(function(e){return e.map((function(e){var t=e.key.split("|");return 1===t.length&&(t=t[0].startsWith("http")?[null,t[0]]:[t[0],null]),{measurementType:t[0],measurementTypeID:t[1],records:e.records}}))}(e.results.measurementTypeCombination))}))}),[]),Object(r.useEffect)((function(){if(n&&n.length>0&&w!==S.current){S.current=w;var e=Object(i.a)(n),t="records"===w?-1:1;e.sort((function(e,n){return e[w]?n[w]&&(null===e||""===e||e[w]>n[w])?t:-t:t})),c(e)}}),[w,n]),Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("nav",{className:"navbar navbar-light bg-light px-4 py-3",children:Object(u.jsx)("a",{className:"text-xl navbar-brand",href:"/",children:"OBIS Measurement Types"})}),Object(u.jsxs)("div",{className:"container-fluid pt-3",children:[Object(u.jsx)("div",{className:"row",children:Object(u.jsxs)("div",{className:"col-xl-6 col-md-8 col-sm-12",children:[Object(u.jsx)("p",{children:"This is an overview of all measurementType(ID) combinations in the OBIS database. Click the number of records in the last column to see the datasets containing a specific measurementType(ID) combination."}),Object(u.jsxs)("p",{children:["Issues at ",Object(u.jsx)("a",{href:"https://github.com/iobis/mof-viewer",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/iobis/mof-viewer"}),"."]})]})}),Object(u.jsx)("div",{className:"row",children:Object(u.jsxs)("div",{className:"col-md-12",children:[Object(u.jsx)("h3",{children:"Datasets"}),C&&Object(u.jsx)("p",{className:"loading",children:"Loading datasets..."}),f&&f.length>0&&Object(u.jsxs)("div",{children:[Object(u.jsxs)("p",{children:["Datasets for ",Object(u.jsxs)("b",{children:[l.measurementType," ",l.measurementTypeID]})]}),Object(u.jsxs)("table",{className:"table table-sm table-hover",children:[Object(u.jsx)("thead",{children:Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{children:"title"}),Object(u.jsx)("th",{children:"node"}),Object(u.jsx)("th",{children:"records"})]})}),Object(u.jsx)("tbody",{children:f.map((function(e,t){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:Object(u.jsx)("a",{href:"https://obis.org/dataset/"+e.id,target:"_blank",rel:"noreferrer noopener",children:e.title})}),Object(u.jsx)("td",{children:e.nodes.map((function(e){return e.name})).join(", ")}),Object(u.jsx)("td",{children:m.format(e.records)})]},t)}))})]})]}),!C&&f&&0===f.length&&Object(u.jsx)("p",{children:"No datasets selected."}),Object(u.jsx)("h3",{children:"Measurement types"}),Object(u.jsx)("div",{className:"pt-2 pb-2",children:Object(u.jsxs)("div",{className:"form-group row",children:[Object(u.jsx)("label",{className:"col-sm-1 col-form-label",htmlFor:"search",children:"Search"}),Object(u.jsx)("div",{className:"col-sm-4",children:Object(u.jsx)("input",{className:"form-control form-control-md",id:"search",type:"text",value:y,onChange:function(e){return T(e.target.value)}})})]})}),n&&n.length>0?Object(u.jsxs)("table",{className:"table table-sm table-hover",children:[Object(u.jsx)("thead",{children:Object(u.jsxs)("tr",{children:[Object(u.jsxs)("th",{className:"cursor-pointer text-nowrap",onClick:function(){return I("measurementType")},children:["measurementType ","measurementType"===w&&Object(u.jsx)("span",{className:"ml-1",children:"\u2193"})]}),Object(u.jsxs)("th",{className:"cursor-pointer text-nowrap",onClick:function(){return I("measurementTypeID")},children:["measurementTypeID ","measurementTypeID"===w&&Object(u.jsx)("span",{className:"ml-1",children:"\u2193"})]}),Object(u.jsx)("th",{className:"cursor-pointer text-nowrap",children:"prefLabel"}),Object(u.jsxs)("th",{className:"cursor-pointer text-nowrap",onClick:function(){return I("records")},children:["records ","records"===w&&Object(u.jsx)("span",{className:"ml-1",children:"\u2193"})]})]})}),Object(u.jsx)("tbody",{children:n.filter((function(e){return!e.hide})).map((function(e,t){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:e.measurementType}),Object(u.jsx)("td",{children:Object(u.jsx)(j.a,{componentDecorator:d,children:e.measurementTypeID})}),Object(u.jsx)("td",{children:e.prefLabel?e.prefLabel:e.measurementTypeID?Object(u.jsx)("span",{className:"actionbutton cursor-pointer",onClick:function(){return function(e){if(e&&e.startsWith("http://vocab.nerc.ac.uk/collection")){var t=e+"?_profile=skos&_mediatype=application/json";t=t.replace("http://","https://"),fetch(t).then((function(e){return e.json()})).then((function(t){if(t&&t.length>0&&"http://www.w3.org/2004/02/skos/core#prefLabel"in t[0]){var r=t[0]["http://www.w3.org/2004/02/skos/core#prefLabel"][0]["@value"],s=n.map((function(t){return t.measurementTypeID===e&&(t.prefLabel=r),t}));c(s)}}))}}(e.measurementTypeID)},children:"find"}):""}),Object(u.jsx)("td",{className:"text-primary cursor-pointer",onClick:function(){return function(e){window.scrollTo(0,0),b(e),O([]),L(!0);var t="https://api.obis.org/dataset?dropped=include&absence=include&";e.measurementType&&(t=t+"measurementtype="+e.measurementType+"&"),e.measurementTypeID&&(t=t+"measurementtypeid"+e.measurementTypeID+"&"),fetch(t).then((function(e){return e.json()})).then((function(e){O(e.results),L(!1)}))}(e)},children:m.format(e.records)})]},t)}))})]}):Object(u.jsx)("p",{className:"loading",children:"Loading measurement types..."})]})})]})]})};a.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(b,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.c5d4c00d.chunk.js.map